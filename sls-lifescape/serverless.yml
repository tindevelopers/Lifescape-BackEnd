# Welcome to Serverless!
#
# This file is the main config file for your service.
# It's very minimal at this point and uses default values.
# You can always add more config options for more control.
# We've included some commented out config examples here.
# Just uncomment any of them to get that config option.
#
# For full config options, check the docs:
#    docs.serverless.com
#
# Happy Coding!

service: LifeScape

# Serverless.com Platform configuration
org: informationnetwork
app: lifescape-backend

# You can pin your service to only deploy with a specific Serverless version
# Check out our docs for more details
frameworkVersion: ">=3.0.0"

provider:
  name: aws
  runtime: nodejs18.x
  versionFunctions: false  
  profile: lifescape
# you can overwrite defaults here
  stage: prod
  region: us-east-1
  environment:
    SITE_URL: https://my.lifescape.com
    DEFAULT_CHANNEL: "My Lifescape"
    AWS_REGIONNAME: us-east-1

  role: arn:aws:iam::872469723818:role/lifescape-sls-role
  # iamRoleStatements:
  # - Effect: Allow
  #   Action:
  #     - s3:*
  #     - dynamodb:*
  #     - lambda:*
  #     - ses:*
  #   Resource: "*"

splitStacks:
  perFunction: false
  perType: true

allowed-headers:
    - Content-Type
    - Authorization
    - Access-Control-Allow-Headers
    - Access-Control-Allow-Origin

plugins:
  - serverless-plugin-split-stacks
  - serverless-reqvalidator-plugin
  # - serverless-aws-documentation  # Temporarily disabled - documentation properties removed

functions:

  createThread:
    handler: thread.create
    events:
      - http:
          path: /thread
          method: post
          cors: true
          integration: lambda

          authorizer: 
            arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
            resultTtlInSeconds: 0

          documentation:
            summary: "Create a Thread"
            description: "Create New Thread"
            requestModels:
              "application/json": createThreadRequest


          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  editThread:
    handler: thread.edit
    events:
      - http:
          path: /user/{user_id}/thread/{thread_id}
          method: PATCH
          cors: true
          integration: lambda  

          authorizer: 
            arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
            resultTtlInSeconds: 0

          documentation:
            summary: "Edit a Thread"
            description: "Edit New Thread"
            #requestModels:
            #  "application/json": createThreadRequest


          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  getThread:
    handler: thread.get
    events:
      - http:
          path: /user/{user_id}/thread/{thread_id}
          method: GET
          cors: true
          integration: lambda

          authorizer: 
            arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
            resultTtlInSeconds: 0

          request:
            parameters:
              paths:
                thread_id: true

          documentation:
            summary: "Get User's Thread"
            description: "Get User's Thread"


          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  deleteThread:
    handler: thread.delete
    events:
      - http:
          path: /user/{user_id}/thread/{thread_id}
          method: delete
          cors: true
          integration: lambda  

          authorizer: 
            arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
            resultTtlInSeconds: 0

          request:
            parameters:
              paths:
                thread_id: 
                  required: true
                  type: string
                user_id: 
                  required: true
                  type: string

          documentation:
            summary: "Delete a Thread"
            description: "Delete a Thread"


          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  addRemoveFavouriteThread:
    handler: thread.addRemoveFavouriteThread
    events:
      - http:
          path: /user/{user_id}/thread/{thread_id}/favourite/{action}
          method: GET
          cors: true
          integration: lambda  

          authorizer: 
            arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
            resultTtlInSeconds: 0

          request:
            parameters:
              paths:
                thread_id: 
                  required: true
                  type: string
                user_id: 
                  required: true
                  type: string
                action: 
                  required: true
                  type: string

          documentation:
            summary: "Add/Remove Thread from Favourite List"
            description: "Add/Remove Thread from Favourite List"


          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  getThreads:
    handler: thread.getThreads
    timeout: 30
    events:
      - http:
          #path: /user/{user_id}/threads/{flag}
          path: /{byfilter}/{byfilter_id}/threads/{flag}
          method: GET
          cors: true
          integration: lambda

          authorizer: 
           arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
           resultTtlInSeconds: 0

          # request:
          #   parameters:
          #     paths:
          #       user_id: true

          documentation:
            summary: "Get User's Threads"
            description: "Get User's Threads"


          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  getPublicThreads:
    handler: thread.getThreads
    timeout: 30
    events:
      - http:
          #path: /user/{user_id}/threads/{flag}
          path: /public/{byfilter}/{byfilter_id}/threads/{flag}
          method: GET
          cors: true
          integration: lambda

          documentation:
            summary: "Get Public Threads"
            description: "Get Public Threads"

          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  searchPublicThreadsByKeyword:
    handler: thread.getThreads
    timeout: 30
    events:
      - http:
          #path: /user/{user_id}/threads/{flag}
          path: /public/{byfilter}/{byfilter_id}/threads/{flag}/kewyord/{kewyord}
          method: GET
          cors: true
          integration: lambda

          documentation:
            summary: "Get Public Threads"
            description: "Get Public Threads"

          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  searchUserThread:
    handler: thread.searchUserThread
    timeout: 30
    events:
      - http:
          path: /user/{user_id}/threads/search/{keyword}
          method: POST
          cors: true
          integration: lambda

          authorizer: 
            arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
            resultTtlInSeconds: 0

          request:
            parameters:
              paths:
                user_id: true

          documentation:
            summary: "Search User's Thread"
            description: "Search User's Thread"


          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  getUserThreadsMedias:
    handler: thread.getUserThreadsMedias
    events:
      - http:
          path: /user/{user_id}/threads/all/medias
          method: GET
          cors: true
          integration: lambda

          authorizer: 
            arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
            resultTtlInSeconds: 0

          request:
            parameters:
              paths:
                user_id: true

          documentation:
            summary: "Get User's Threads Medias"
            description: "Get User's Threads Medias"


          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


 
  createMoment:
    handler: moment.createMoment
    timeout: 20
    events:
      - http:
          documentation:
            summary: "Create New Moment"
            description: "Create New Moment"
            requestModels:
              "application/json": createMomentRequest

          authorizer: 
            arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
            resultTtlInSeconds: 0

          path: /moment
          method: post
          cors: true
          integration: lambda

 

          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  editMoment:
    handler: moment.editMoment
    events:
      - http:
          path: /user/{user_id}/moment/{object_id}
          method: patch
          cors: true
          integration: lambda  

          authorizer: 
            arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
            resultTtlInSeconds: 0

          documentation:
            summary: "Edit a Moment"
            description: "Edit Moment"
            requestModels:
              "application/json": editMomentRequest

          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  editMomentBlockStatus:
    handler: moment.editMomentBlockStatus
    events:
      - http:
          path: /user/{user_id}/moment/{object_id}/block/{block_status}
          method: patch
          cors: true
          integration: lambda  

          authorizer: 
            arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
            resultTtlInSeconds: 0

          documentation:
            summary: "Block/Unblock Moment"
            description: "Block/Unblock Moment"
            # requestModels:
            #   "application/json": editMomentRequest

          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  deleteMoment:
    handler: moment.deleteMoment
    events:
      - http:
          path: /user/{user_id}/moment/{object_id}
          method: delete
          cors: true
          integration: lambda  

          authorizer: 
            arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
            resultTtlInSeconds: 0

          request:
            parameters:
              paths:
                object_id: 
                  required: true
                  type: string                  
                user_id: 
                  required: true
                  type: string

          documentation:
            summary: "Delete a Moment"
            description: "Delete Moment"

          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  getMomentDetail:
    handler: moment.getMomentDetail
    events:
      - http:
          path: /moment/{object_id}
          method: get
          cors: true
          integration: lambda

          request:
            parameters:
              paths:
                object_id: 
                  required: true
                  type: string

          documentation:
            summary: "Get a Moment Detail"
            description: "Get a Moment Detail"

          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"                      
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"



  getMomentDetailNew:
    handler: moment.getMomentDetail
    events:
      - http:
          path: /user/{user_id}/moment/{object_id}
          method: get
          cors: true
          integration: lambda

          authorizer: 
            arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
            resultTtlInSeconds: 0

          request:
            parameters:
              paths:
                object_id: 
                  required: true
                  type: string                  
                user_id: 
                  required: true
                  type: string

          documentation:
            summary: "Get a Moment Detail"
            description: "Get a Moment Detail"

          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"



  inviteUsersToObject:
    handler: user.inviteUsersToObject
    events:
      - http:
          path: /user/{user_id}/invite
          method: POST
          cors: true
          integration: lambda

          authorizer: 
            arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
            resultTtlInSeconds: 0

          request:
            parameters:
              paths:
                user_id: 
                  required: true
                  type: string

          documentation:
            summary: "User Send Friend Invitation"
            description: "User Send Friend Invitation"

          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  searchGlobal:
    handler: moment.searchGlobal
    events:
      - http:
          path: /user/{user_id}/search/{keyword}
          method: get
          cors: true
          integration: lambda

          authorizer: 
            arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
            resultTtlInSeconds: 0


          documentation:
            summary: "Search People, Moments, Locations"
            description: "Search People, Moments, Locations"


          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  getObjects:
    handler: moment.getObjects
    events:
      - http:
          #path: /user/{user_id}/{byfilter{/{byfilter_id}/objects/{object_type}
          path: /{byfilter}/{byfilter_id}/objects/{object_type}
          method: post
          cors: true
          integration: lambda  

          authorizer: 
            arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
            resultTtlInSeconds: 0

          documentation:
            summary: "Get User's Object Data with Full Detail"
            description: "Get User's Object Data with Full Detail"


          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  getPublicObjects:
    handler: moment.getObjects
    events:
      - http:
          #path: /user/{user_id}/{byfilter{/{byfilter_id}/objects/{object_type}
          path: /public/{byfilter}/{byfilter_id}/objects/{object_type}
          method: post
          cors: true
          integration: lambda  

          documentation:
            summary: "Get Public Object Data with Full Detail"
            description: "Get Public Object Data with Full Detail"


          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  saveMedia:
    handler: media.saveMedia
    events:
      - http:
          path: media
          method: post
          cors: true
          integration: lambda

          authorizer: 
            arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
            resultTtlInSeconds: 0
  
          documentation:
            summary: "save Media URL and Detail"
            description: "save Media URL and Detail"
            requestModels:
              "application/json": mediaRequest

          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  saveMedias:
    handler: media.saveMedias
    events:
      - http:
          path: /medias
          method: post
          cors: true
          integration: lambda

          authorizer: 
            arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
            resultTtlInSeconds: 0
  
          documentation:
            summary: "save Medias URL and Detail"
            description: "save Medias URL and Detail"
#            requestModels:
#              "application/json": mediaRequest

          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  # saveMedia:
  #   handler: media.saveMedia
  #   events:
  #     - http:
  #         path: media
  #         method: post
  #         cors: true
  #         integration: lambda

  #         authorizer: 
  #           arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
  #           resultTtlInSeconds: 0
  
  #         documentation:
  #           summary: "save Media URL and Detail"
  #           description: "save Media URL and Detail"
  #           requestModels:
  #             "application/json": mediaRequest

  #         response:
  #           template: $input.path('$')
  #           statusCodes:
  #               500:
  #                   pattern: '.*"statusCode":500.*' # JSON response
  #                   template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
  #                   headers:
  #                     Content-Type: "'application/json'"
  #               400:
  #                   pattern: '.*"statusCode":400.*' # JSON response
  #                   template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
  #                   headers:
  #                     Content-Type: "'application/json'"
  #               404:
  #                   pattern: '.*"statusCode":404.*' # JSON response
  #                   template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
  #                   headers:
  #                     Content-Type: "'application/json'"


  getMedias:
    handler: media.getMedias
    events:
      - http:
          path: /moment/{object_id}/medias
          method: GET
          cors: true
          integration: lambda

          authorizer: 
            arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
            resultTtlInSeconds: 0

          documentation:
            summary: "get Moment Medias"
            description: "get Moment Medias"

          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  saveMomentLikes:
    handler: moment.saveMomentLikes
    events:
      - http:
          path: /moment/{object_id}/saveLike
          method: post
          cors: true
          integration: lambda

          authorizer: 
            arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
            resultTtlInSeconds: 0

          documentation:
            summary: "save Like/Dislike Moment"
            description: "like or dislike the moment by User"
            requestModels:
              "application/json": likemomentRequest

          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"message":"server_error".*' # JSON response
                    template: $input.path("$.errorMessage") # JSON return object
                    headers:
                      Content-Type: "'application/json'"
                404:
                  pattern: '.*"message":"not_found".*' # JSON response
                  template: $input.path("$.errorMessage") # JSON return object
                  headers:
                    Content-Type: "'application/json'"

            statusCode: '404'
            responseModels:
              "application/json": 400JsonResponse

  getMomentLikeCounter:
    handler: moment.getMomentLikeCounter
    events:
      - http:
          path: /moment/{object_id}/like/counter
          method: GET
          cors: true
          integration: lambda

          authorizer: 
            arn: arn:aws:lambda:us-east-1:872469723818:function:Auth-dev-authorizer
            resultTtlInSeconds: 0

          documentation:
            summary: "get Moment's Like/Dislike Counter"
            description: "get Moment's Like/Dislike Counter"


          response:
            template: $input.path('$')
            statusCodes:
                500:
                    pattern: '.*"statusCode":500.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                400:
                    pattern: '.*"statusCode":400.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"
                404:
                    pattern: '.*"statusCode":404.*' # JSON response
                    template: '#set ($errorMessageObj = $util.parseJson($input.path("$.errorMessage"))) { "message" : "$errorMessageObj.message" }' 
                    headers:
                      Content-Type: "'application/json'"


  # getUserFriendStatus:  # Firebase removed - function disabled
  # #handler: user.getUserFriends
  # getUserFriendList:  # Firebase removed - function disabled
  # #handler: user.getUserFriends
  # getUserSuggestedFriends:  # Firebase removed - function disabled
  # sendFriendRequest:  # Firebase removed - function disabled
  # unFriendUser:  # Firebase removed - function disabled
  # actOnFriendRequest:  # Firebase removed - function disabled
  # listRequests:  # Firebase removed - function disabled
  # signup:  # Firebase removed - function disabled
  # editProfile:  # Firebase removed - function disabled
  # editProfilePicture:  # Firebase removed - function disabled
  # createUserGroup:  # Firebase removed - function disabled
  # editUserGroup:  # Firebase removed - function disabled
  # deleteUserGroup:  # Firebase removed - function disabled
  # getUserGroups:  # Firebase removed - function disabled
  # getUserGroupFriends:  # Firebase removed - function disabled
  # resetPassword:  # Firebase removed - function disabled
  # changePassword:  # Firebase removed - function disabled
  # login:  # Firebase removed - function disabled
  # getUserDetail:  # Firebase removed - function disabled
  # registerDeviceID:  # Firebase removed - function disabled
